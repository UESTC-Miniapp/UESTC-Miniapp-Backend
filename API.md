# UESTC-Life API 接口文档

首先，如果响应为空，一律视为错误。  
其次，所有响应json的情况，
无论是Array还是Object，都是字符串，没有数字。

### 登录页

登录可以用于验证学号和密码。

#### `login.php` - `POST`  

**@request:**  
```js
{
  username: String,
  passwd: String,
  cap: String // 可选，字段为空则不发送验证码
}
```

**@return:**  
```js
{
  success: Boolean,
  error_code: Number, // 在这里列举错误码
  error_msg: String, // 用于返回错误详情
  cap_img: String, // 可选，base64编码后的验证码图片，如果直接登录成功，该字段为空
  token: String // 如果登录成功，则返回token，如果需要验证码，该字段为空
}
```

状态码|含义|备注
:---:|:---:|:---:
1|正常登录|/
2|需要验证码|验证码图片通过bae64转换后放置在content中
3|学号或密码错误|/
4|验证码错误|/
5|后端系统错误|/
6|请求错误|一般是错误的code
7|token错误|这种情况最好是重新登录吧
## 检测token
用于确认token所属的cookie是否有效
- （表一）属性：

属性|属性值|备注
:---:|:---:|:---:
URL|check_token.php|/
method|POST|/
响应格式|JSON|见下
- （表二）请求参数：

参数名|参数值|备注
:---:|:---:|:---:
username|学号|/
token|废话|/
- （表三）响应：
响应是一个数字，
1=cookie依然有效
2=cookie已经失效
3=验证错误（token与username不一致或者没有这个学号）
4=服务器系统错误（一般是数据库没连上）
## 成绩信息
读取成绩信息需要提交学号、token和semesterId。
- （表一）属性

属性|属性值|备注
:---:|:---:|:---:
URL|grade.php|/
method|POST|/
响应格式|JSON|不包含标题
- （表二）请求参数：

参数名|参数值|备注
:---:|:---:|:---:
username|学号|/
token|你懂的|/
semesterId|学年学期|可以为空，但必须要有

- 响应：  
响应的格式是一个json字符串，
包含状态码code和内容content。
如果正常的话，code=1，
content的内容是一个二维json，两个纬度都是Array，
不包含标题。
如果code不为1，则没有content。
标题是固定的
```
学年学期|课程代码|课程序号|课程名称|课程类别|学分|总评成绩|补考总评|最终|绩点
```
- （表三）响应状态码：

状态码|含义|备注
:---:|:---:|:---:
1|正常|/
2|token错误|建议重新登录
3|系统错误|一般是数据库没连上
4|请求错误|一般是没提供username或者token

## 课程表


## 考试信息

读取考试信息需要提交学号、token和semesterId。
- （表一）属性

属性|属性值|备注
:---:|:---:|:---:
URL|exam.php|/
method|POST|/
响应格式|JSON|包含标题
- （表二）请求参数：

参数名|参数值|备注
:---:|:---:|:---:
username|学号|/
token|你懂的|/
semesterId|学年学期|可以为空，但必须要有
examTypeId|考试类型|1=期末考试，2=期中考试，3=补考，4=缓考
- 响应：  
响应的格式是一个json字符串，
包含状态码（code）和内容（content）。
当然如果出错的话就只有状态码没有内容。
为了节省空间，
在content中使用array而不是object，
毕竟用object的话，key都是一样的。
有些考试会有`[考试情况未发布]`，
那么对应的字段就是空串，
所以每个array的长度固定。
第一个数字将提示是否为未发布，  
`0` = 未发布  
`1` = 正常

正常的情况是  
`课程序号|课程名称|考试日期|考试安排|考试地点|座位号|考试情况|其它说明`  
而出现未发布的话，一般从`考试日期`到`考试情况`。
- （表三）响应状态码：

状态码|含义|备注
:---:|:---:|:---:
1|正常|/
2|token错误|建议重新登录
3|系统错误|一般是数据库没连上
4|请求错误|一般是没提供username或者token
